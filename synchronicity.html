<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Synchronicity Reader ‚Äî Mystical Pro v4 (Ultra‚ÄëLong)</title>
<style>
  :root{ --bg:#05090a; --card:#081215; --edge:#102227; --text:#d1f7ff; --mint:#7efcff; --muted:#9bc7d1; --ok:#a7ffd8; --err:#ff9b9b }
  *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:1000px;margin:0 auto;padding:22px 16px 40px}
  h1{margin:0 0 6px;color:var(--mint)}
  .sub{margin:0 0 16px;color:var(--muted)}
  .card{background:var(--card);border:1px solid var(--edge);border-radius:14px;padding:16px;margin:14px 0}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
  .kpi{background:#0b1214;border:1px solid var(--edge);border-radius:10px;padding:12px}
  .kpi h3{margin:0 0 6px;color:var(--mint);font-size:15px}
  .kpi div{font-weight:700;font-size:20px;font-family:ui-monospace,Menlo,Consolas,monospace}
  label{font-weight:600;display:block;margin:.4rem 0 .2rem}
  input,button,select{font:inherit;border-radius:10px;border:1px solid var(--edge);background:#0b1214;color:#d1f7ff;padding:.55rem .7rem}
  button{cursor:pointer}
  .chip{display:inline-block;border:1px solid #1f3b41;border-radius:999px;padding:4px 8px;margin:4px 6px 0 0;color:#9bc7d1;font-size:12px}
  .long{white-space:pre-line;line-height:1.75}
  .tiny{font-size:12px} .muted{color:var(--muted)} .ok{color:var(--ok)} .err{color:var(--err)}
  .tts{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .disclaimer{font-size:12px;color:#9bc7d1;margin-top:6px}
  .pill{display:inline-block;padding:4px 10px;border:1px solid #1f3940;border-radius:999px;margin-right:8px;color:#8fd7e3;font-size:12px}
  h2,h3{margin:10px 0 6px}
</style>
</head>
<body>
  <div class="wrap">
    <h1>üî¢ Synchronicity Reader ‚Äî Mystical Pro v4</h1>
    <p class="sub">Ultra‚Äëlong, flowing segments (‚âà400‚Äì500 words each). Clean narration. Google voices only.</p>

    <section class="card">
      <div class="row">
        <label>Synchronicity number
          <input id="num" placeholder="e.g., 2011, 2222, 1234" style="min-width:220px">
        </label>
        <label>Tone
          <select id="tone">
            <option value="light">Mystical ‚Äî Light</option>
            <option value="rich" selected>Mystical ‚Äî Rich (Long)</option>
            <option value="plain">Plain‚ÄëEnglish (Long)</option>
          </select>
        </label>
        <button id="analyzeBtn">Analyze</button>
        <button id="copyBtn">Copy reading</button>
        <button id="copyHtmlBtn">Copy as HTML</button>
        <span id="status" class="tiny muted" style="margin-left:auto"></span>
      </div>
      <div class="tts" style="margin-top:8px">
        <span class="pill">Narrator</span>
        <label>Voice <select id="voiceSelect"></select></label>
        <label class="tiny"><input type="checkbox" id="forceEnglish" checked> English only</label>
        <label class="tiny">Rate <input type="range" id="rate" min="0.6" max="1.4" step="0.02" value="0.98"></label>
        <label class="tiny">Pitch <input type="range" id="pitch" min="0.6" max="1.4" step="0.02" value="1.0"></label>
        <button id="testVoiceBtn">Test</button>
        <button id="speakBtn">Speak</button>
        <button id="stopBtn">Stop</button>
      </div>
      <div class="disclaimer">Narration uses a cleaned version of the text (no symbols or hashes). Reflective guidance only.</div>
    </section>

    <section class="card" id="resultCard" style="display:none">
      <div class="grid">
        <div class="kpi"><h3>Segments (2‚Äëdigit)</h3><div id="segments">‚Äî</div></div>
        <div class="kpi"><h3>Segment Bases</h3><div id="bases">‚Äî</div></div>
        <div class="kpi"><h3>Final Base</h3><div id="finalBase">‚Äî</div></div>
      </div>

      <h3>Tarot & Astro Mapping</h3>
      <div id="chips"></div>

      <h3>Reading</h3>
      <div id="reading" class="long">‚Äî</div>
    </section>

    <section class="card tiny muted">
      Data: <code>synchronicity_mapping.json</code> + <code>synchronicity_overrides.json</code>. Only <strong>Google</strong> voices are listed. Speech removes symbols like arrows and bullets.
    </section>
  </div>

<script>
const MAP_URL = 'synchronicity_mapping.json?v='+Date.now();
const OV_URL  = 'synchronicity_overrides.json?v='+Date.now();

const $ = id => document.getElementById(id);
let DB = null, OV = null;

// ===== helpers =====
function splitPairsLeft(str){ const s=String(str).replace(/\\D/g,''); if(!s) return []; const out=[]; for(let i=0;i<s.length;i+=2) out.push(s.slice(i,i+2)); return out; }
function reduceDigit(n){ n=String(n).replace(/\\D/g,''); if(!n) return null; let sum=0; for(const ch of n) sum+=Number(ch); while(sum>9){ let t=0; for(const ch of String(sum)) t+=Number(ch); sum=t; } return sum; }
function segmentBase(seg){ if(OV[seg]) return { base: OV[seg].base, master: seg, ov:OV[seg] }; return { base: reduceDigit(seg), master:null, ov:null }; }
function unique(arr){ return Array.from(new Set(arr.filter(Boolean))); }
function mapDigitToEntry(d){ const db=(DB && (DB.numbers||DB))||{}; return db[String(d)] || {}; }
function minorsForBase(d){ const names={1:'Ace',2:'Two',3:'Three',4:'Four',5:'Five',6:'Six',7:'Seven',8:'Eight',9:'Nine'}; const label=names[d]; if(!label) return []; return [`${label} of Wands`,`${label} of Cups`,`${label} of Swords`,`${label} of Pentacles`]; }

// ===== anchor long texts =====
const ANCHOR = {
8:{
  title:"Calm Strength",
  theme:"resources and sustained effort",
  plain:`Power grows when it is kind and repeatable. Choose one routine you can keep for eight days, and let results rather than moods be your feedback. When your attention splinters, return to the bench: the hand memory of your craft is older than doubt. Speak one clear message, release one tie that quietly drains you, untie one thought-knot with a single fact, and practice one precise motion until it becomes smooth. Imagine coals that hold heat just below orange; you work without rush, letting the iron answer your timing. Mastery is not a thunderclap. It‚Äôs the quiet promise you keep until it becomes the weather around you.`,
  light:`The forge hums at a low heat, steady as breath. Strength here is the courtesy of repetition‚Äîacts done with care, not noise. You place the work in the fire, take it out at the right moment, and the metal gives. A message sent at the right time lands. A habit repeated becomes a hallway your future can walk down. The Star keeps you aimed toward a horizon, while Strength keeps your tone warm. Choose one practice and keep it gentle and exact for eight days. The day will learn to lean in your direction.`,
  rich:`Coals rise like a small constellation. The hammer is where you left it, and the trough writes steam‚Äëscript you no longer chase. Strength is the soft hand that tames the lion; the Star is the well that never argues with the night. Today you marry will to blessing. Send one true signal; let one stale tether float; loosen the wire of one anxious thought; and return to the bench where stitches, strokes, or strikes turn into prayer. You will not need to shout. You will keep time, and time will keep you.`
}
};

// ===== category guidance (longer) keyed by anchor 1..9 (only 8 expanded here for brevity) =====
const CAT = {
8:{
  love:`Lead with warmth and consistency. Promise small and keep it. If you‚Äôre partnered, make one weekly ritual that refuses drama: tea and a ten‚Äëminute check‚Äëin, a shared budget that feels kind, a simple plan you both can trust. Speak plainly about energy and time, not blame. If you‚Äôre single, let your craft be your lighthouse; like recognizes like. The right person feels the steadiness of your rhythm and meets you there.`,
  work:`Build the system that will still exist next month. Name the pipeline stages in human words. Decide your ‚Äúdefinition of done.‚Äù Track reps and outcomes, not moods. Send one concise update with dates and numbers. If a task repeats, template it. If a step never helps, retire it. Calm strength wins the week.`,
  confusion:`You don‚Äôt need a bigger map; you need traction. Choose the lever with the most return and pull it gently, daily. Reduce inputs. The thing that looks hard often becomes easy at the hundredth repetition. Let metrics, not fear, decide.`,
  family:`Offer structure without steamrolling. Post the plan where everyone can see it. Put care into the frame: shared calendar, budget that doesn‚Äôt shame, chores that rotate. Praise keeping the cadence, not perfection. Consistency is love made visible.`,
  frustration:`Frustration is latent motion. Channel it through craft for ten quiet minutes. When the hands move, the mind unclenches. Then speak one clear sentence that moves the situation by an inch. Do not try to move miles today.`
}
};

// ===== LONG segment generator (‚âà400‚Äì500 words) =====
function longSegmentHTML(idx, rawSeg, base, majors, minors, signs, master, tone){
  // Fallback phrasing for majors/signs if DB lacks entries
  const majTxt = majors.length? `${majors.join(', ')}` : (base===4? 'Emperor, Death (13)' : base===8? 'Strength, Star (17)' : 'key archetypes for this number');
  const signTxt = signs.length? `${signs.join(', ')}` : (base===4? 'Aries and Scorpio' : base===8? 'Leo and Aquarius' : 'signs that mirror this theme');

  const baseNames={1:'Ace',2:'Two',3:'Three',4:'Four',5:'Five',6:'Six',7:'Seven',8:'Eight',9:'Nine'};
  const baseName = baseNames[base]||String(base);
  const quartet = minors.length? minors.join(', ') : `${baseName} of Wands, ${baseName} of Cups, ${baseName} of Swords, ${baseName} of Pentacles`;

  // Tone shadings
  const open_plain = `Segment ${idx} (${rawSeg} to ${base}) asks you to turn meaning into something you can see. In the Majors, ${majTxt} set expectations. In the Minors, the ${baseName}s appear as ${quartet}. Astrologically, ${signTxt} colour the atmosphere.${master? ` This arrives as Master ${master} stepping down to ${base}: the big idea choosing practical form.`:''}`;
  const open_light = `Segment ${idx} (${rawSeg} to ${base}) opens with a steady invitation to make the invisible visible. In the Majors, ${majTxt} step forward; in the Minors, the ${baseName}s show as ${quartet}. The sky leans through ${signTxt}. ${master? `Master ${master} descends to ${base}, reminding you that voltage prefers good grounding.`:''}`;
  const open_rich  = `Segment ${idx} (${rawSeg} to ${base}) changes the air the way a door to a calm workshop changes light. The Major Arcana speak through ${majTxt}; the Minors gather as ${quartet}. ${signTxt} whisper their weather across the scene.${master? ` This is Master ${master} resolving into ${base}, proof that large currents ask for simple vessels.`:''}`;

  const open = (tone==='plain'? open_plain : tone==='light'? open_light : open_rich);

  // Block 2: What to do ‚Äî expanded triad, detailed
  const do_plain = `Treat this segment like a small altar to ${baseName} energy. First, protect a clear block of time where this work can breathe‚Äîphone down, tabs closed, a surface cleared on purpose. Second, send one message that aligns someone useful: a request, an update, or a boundary. Third, retire one stale move, tool, or idea that wastes effort. The point is not intensity; it is clean repetition.`;
  const do_light = `Make a room inside the day. Guard one honest hour, and let it be ordinary and beautiful. Offer one clear signal to the world that you are here and building. Lay down one habit that creaks and slows the gate of your momentum. As you repeat this quiet triad, intention condenses into form.`;
  const do_rich  = `Give this current a shape. Set apart an hour that belongs to it and nothing else. Send a single message that rings true and lands where it should. Allow one old pattern to loosen and fall. With each repetition the work accrues weight and the room remembers your name.`;
  const doText = (tone==='plain'? do_plain : tone==='light'? do_light : do_rich);

  // Block 3: How it feels / obstacles
  const feel_plain = `Expect a mix of relief and resistance. Relief because decisions shrink the field and free attention; resistance because the part of you that loves options will mourn lost noise. When doubt speaks, measure instead of guessing. When the plan feels rigid, add a window: five minutes for stretch, water, or a kind check‚Äëin. Structure is a frame, not a cage.`;
  const feel_light = `You may feel the day exhale when you choose, and your restless mind tug when you hold the line. When it tugs, soften, not shatter. Add a breath, a sip of water, a glance at something living. Let structure be a kindness that keeps the river in its honest banks.`;
  const feel_rich  = `There is a hush when a decision lands, and a small choir of second thoughts when you keep it. Invite the hush to stay by courting it: light tidy, water nearby, a brief bow to whatever you believe. The frame you build is a mercy‚Äîit lets the wildness of your talent bloom against something true.`;
  const feelText = (tone==='plain'? feel_plain : tone==='light'? feel_light : feel_rich);

  // Block 4: Micro‚Äëexamples tailored by base
  const examplesByBase = {
    4:`Examples: write a two‚Äëstep checklist for a task you repeat; rename folders so the next version has a clear home; put the timer on and let the first draft be allowed to exist.`,
    8:`Examples: pick one drill that improves your craft by one percent; schedule short updates with simple numbers; practice the stroke or stitch until your hand finds the groove.`,
    2:`Examples: set a weekly check‚Äëin with one partner; draft a decision rule you both agree to; decline one request with warmth and clarity.`,
    3:`Examples: record a one‚Äëminute demo; ask for one reaction; publish a small note instead of polishing for days.`,
    5:`Examples: try a tiny version of the change with safe stakes; take notes on what moved; adjust without drama.`,
    6:`Examples: define ‚Äúdone well‚Äù for one repeating task; clean one corner of the space you live or work in; ask what would actually help, then do just that.`,
    7:`Examples: choose a single source to study and close the rest; write a half‚Äëpage of findings; take one action that follows from the page.`,
    1:`Examples: send the opening email; name the project and make its first folder; write the first paragraph only.`,
    9:`Examples: finish and archive one thread; say the goodbye you have been postponing; donate the tool you no longer use.`
  };
  const examples = examplesByBase[base] || `Examples: choose one small act that obviously lives at this number‚Äôs frequency and repeat it without ceremony.`;

  // Block 5: Soft image
  const images = {
    4:`a bench by a window and four patient stones`,
    8:`coals in a quiet forge, a rhythm your hands remember`,
    2:`two lanterns keeping easy time on a narrow bridge`,
    3:`three chosen stalls in a bright market`,
    5:`a small sail trimmed to the honest wind`,
    6:`a warm stove and a chair moved two inches to fit the doorway`,
    7:`a desk, a single window, a page that answers`,
    1:`a key and a first light in a plain room`,
    9:`a tide line where you keep one shell and let the rest go`
  };
  const img = images[base] || `a simple scene that fits today`;
  const image_plain = `Picture ${img}. You do fewer things, more on purpose, and the day takes the right shape.`;
  const image_light = `Picture ${img}. Intention chooses a frame and the world meets you there.`;
  const image_rich  = `Picture ${img}. By doing less, more on purpose, you watch the day decide to resemble you.`;
  const image = (tone==='plain'? image_plain : tone==='light'? image_light : image_rich);

  // Assemble paragraphs ‚Äî aim ~450‚Äì500 words
  const paragraphs = [open, doText, feelText, examples, image];
  return paragraphs.map(t=>`<p>${t}</p>`).join('\n');
}

// ===== chips =====
function buildChips(basesInfo, segs){
  const chipHtml = [];
  basesInfo.forEach(({base, master, ov}, idx) => {
    const entry = mapDigitToEntry(base);
    const majors = entry.majors || entry.Majors || [];
    const signs  = unique([...(entry.signs||entry.Signs||[]), ...(ov && ov.signs || [])]);
    const minors = minorsForBase(base);
    chipHtml.push(`<div class="chip">Seg ${idx+1}: ${segs[idx]} ‚Üí ${master? master+'‚Üí':''}${base} ¬∑ ${signs.join('/')} ¬∑ Majors: ${(majors.length?majors.join(', '):'‚Äî')} ¬∑ Minors: ${minors.join(', ')}</div>`);
  });
  return chipHtml.join('');
}

// ===== full reading =====
function buildReadingHTML(num, segs, basesInfo, finalBase){
  const tone = $('tone').value;
  const anchor = (ANCHOR[finalBase] || {title:'Anchor', theme:'', plain:'', light:'', rich:''});
  const story = (tone==='plain'? anchor.plain : tone==='light'? anchor.light : anchor.rich) || '';
  const parts = [];
  parts.push(`<h2>${num} ‚Äî ${anchor.title||'‚Äî'}</h2>`);
  parts.push(`<p>We split ${num} into ${segs.join(', ')}. Adding the bases resolves to ${finalBase}: ${anchor.theme||''}.</p>`);

  basesInfo.forEach((info, i)=>{
    const entry = mapDigitToEntry(info.base);
    const majors = entry.majors || entry.Majors || [];
    const signs  = unique([...(entry.signs||entry.Signs||[]), ...(info.ov && info.ov.signs || [])]);
    const minors = minorsForBase(info.base);
    parts.push(`<h3>Segment ${i+1} ‚Äî ${info.master? 'Master '+info.master+' ‚Üí ':''}${info.base}</h3>`);
    parts.push(longSegmentHTML(i+1, segs[i], info.base, majors, minors, signs, info.master, tone));
  });

  parts.push(`<h3>Anchor ‚Äî ${finalBase}</h3>`);
  parts.push(`<p>${story}</p>`);

  const cat = (CAT[finalBase] || {});
  if (cat.love) { parts.push(`<h3>If the question is Love</h3><p>${cat.love}</p>`); }
  if (cat.work) { parts.push(`<h3>If the question is Work/Vocation</h3><p>${cat.work}</p>`); }
  if (cat.confusion) { parts.push(`<h3>If the question is Confusion</h3><p>${cat.confusion}</p>`); }
  if (cat.family) { parts.push(`<h3>If the question is Family</h3><p>${cat.family}</p>`); }
  if (cat.frustration) { parts.push(`<h3>If the question is Frustration</h3><p>${cat.frustration}</p>`); }

  parts.push(`<p>‚Äî Spirit Guide App</p>`);
  return parts.join('\n');
}

// ===== UI actions =====
function analyze(){
  const raw = $('num').value.trim();
  if(!raw){ alert('Enter a number.'); return; }

  const segs = splitPairsLeft(raw);
  const basesInfo = segs.map(s => segmentBase(s));
  const bases = basesInfo.map(x => x.base);
  const finalBase = reduceDigit(bases.reduce((a,b)=>a+b,0));

  $('resultCard').style.display = 'block';
  $('segments').textContent = segs.join(', ');
  $('bases').textContent = basesInfo.map(x => (x.master? x.master+'‚Üí':'') + x.base).join(', ');
  $('finalBase').textContent = String(finalBase);
  $('chips').innerHTML = buildChips(basesInfo, segs);

  const html = buildReadingHTML(raw, segs, basesInfo, finalBase);
  $('reading').innerHTML = html;

  $('status').textContent = 'Done';
  setTimeout(()=> $('status').textContent='', 2000);
}

function copyReading(){ 
  const txt = getSpeechText(($('reading').innerHTML||'').trim());
  navigator.clipboard.writeText(txt + '\n‚Äî Spirit Guide App').then(()=> alert('Copied reading (speech‚Äëfriendly)'));
}
function copyReadingHtml(){
  const html = $('reading').innerHTML;
  const blob = new Blob([html], {type:'text/html'});
  const reader = new FileReader();
  reader.onload = function(){ navigator.clipboard.writeText(reader.result).then(()=> alert('Copied HTML')); };
  reader.readAsText(blob);
}
$('analyzeBtn').onclick = analyze;
$('copyBtn').onclick = copyReading;
$('copyHtmlBtn').onclick = copyReadingHtml;

// ===== Narrator (Google‚Äëonly) + speech sanitizer =====
const STORAGE = { name:'sg_voice_name', lang:'sg_voice_lang', force:'sg_voice_force_en', rate:'sg_voice_rate', pitch:'sg_voice_pitch' };
const prefer = ["Google UK English Female","Google UK English Male","Google US English","Google US English Female","Google US English Male"];
let voices = [];
function isGoogle(v){ return /google/i.test(v.name||''); }
function englishOnly(v){ return $('forceEnglish').checked ? /^en[-_]/i.test(v.lang||'') : true; }
function populateVoices(){
  const list = window.speechSynthesis.getVoices()||[];
  if(!list.length){ setTimeout(populateVoices, 250); return; }
  voices = list.filter(v => isGoogle(v) && englishOnly(v));
  const sel = $('voiceSelect'); sel.innerHTML='';
  voices.forEach(v=>{ const opt=document.createElement('option'); opt.value=v.name+'::'+v.lang; opt.textContent=`${v.name} (${v.lang})`; sel.appendChild(opt); });

  const savedName = localStorage.getItem(STORAGE.name), savedLang = localStorage.getItem(STORAGE.lang);
  if(savedName && savedLang){
    const idx = Array.from(sel.options).findIndex(o => o.value === (savedName+'::'+savedLang));
    if(idx>=0){ sel.selectedIndex=idx; } else { sel.selectedIndex=0; }
  } else {
    let picked=false;
    for(const p of prefer){
      const idx = Array.from(sel.options).findIndex(o => o.textContent.includes(p));
      if(idx>=0){ sel.selectedIndex=idx; picked=true; break; }
    }
    if(!picked && sel.options.length) sel.selectedIndex=0;
  }
}
function currentVoice(){
  const sel = $('voiceSelect'); if(!sel || sel.selectedIndex<0) return null;
  const [name, lang] = sel.value.split('::');
  return (window.speechSynthesis.getVoices()||[]).find(v => v.name===name && v.lang===lang) || null;
}
function savePrefs(){
  const sel = $('voiceSelect'); const [name, lang] = (sel.value||'::').split('::');
  localStorage.setItem(STORAGE.name, name||''); localStorage.setItem(STORAGE.lang, lang||'');
  localStorage.setItem(STORAGE.force, $('forceEnglish').checked ? '1':'0');
  localStorage.setItem(STORAGE.rate, String($('rate').value)); localStorage.setItem(STORAGE.pitch, String($('pitch').value));
}
function loadPrefs(){
  $('forceEnglish').checked = localStorage.getItem(STORAGE.force) === '1';
  const r = parseFloat(localStorage.getItem(STORAGE.rate)); if(!isNaN(r)) $('rate').value = r;
  const p = parseFloat(localStorage.getItem(STORAGE.pitch)); if(!isNaN(p)) $('pitch').value = p;
}
function decodeEntities(html){
  const txt = document.createElement('textarea'); txt.innerHTML = html; return txt.value;
}
function getSpeechText(html){
  let text = decodeEntities(html);
  text = text.replace(/<script[\s\S]*?<\/script>/gi,' ')
             .replace(/<style[\s\S]*?<\/style>/gi,' ')
             .replace(/<[^>]+>/g,' ');
  text = text.replace(/‚Üí/g,' to ').replace(/‚Ä¢/g,', ').replace(/[#*_`~^]/g,' ').replace(/\s{2,}/g,' ').trim();
  return text;
}
function speak(textHtml){
  if(!('speechSynthesis' in window)) return alert('Speech not supported here.');
  window.speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance();
  const cleaned = getSpeechText(textHtml || $('reading').innerHTML || '');
  u.text = "Reflective guidance only. " + (cleaned || 'Please analyze a number first.');
  u.rate = parseFloat($('rate').value||'1'); u.pitch = parseFloat($('pitch').value||'1'); u.volume = 1.0;
  const v = currentVoice(); if(v) u.voice = v;
  window.speechSynthesis.speak(u);
}
$('testVoiceBtn').onclick = ()=>{ savePrefs(); speak('Hello'); };
$('speakBtn').onclick     = ()=> speak();
$('stopBtn').onclick      = ()=> window.speechSynthesis && window.speechSynthesis.cancel();
$('voiceSelect').onchange = savePrefs;
$('forceEnglish').onchange= ()=>{ savePrefs(); populateVoices(); };
$('rate').oninput = savePrefs; $('pitch').oninput = savePrefs;

if('speechSynthesis' in window){
  loadPrefs();
  window.speechSynthesis.onvoiceschanged = populateVoices;
  populateVoices();
} else {
  $('status').textContent = 'Speech not supported in this browser';
}

// Ready
Promise.all([fetch(MAP_URL).then(r=>r.json()).catch(()=>null),
             fetch(OV_URL).then(r=>r.json()).catch(()=>({}))])
  .then(([map, ov]) => {
    DB = map || {}; OV = ov || {};
    $('status').textContent = 'Ready';
    setTimeout(()=> $('status').textContent='', 1500);
  });
</script>
</body>
</html>
